{%- if 'reggie' in minion_id -%}

{%- set env = __grains__.get('env') -%}
{%- set event_name = __grains__.get('event_name') -%}
{%- set event_year = __grains__.get('event_year') -%}
{%- set roles = __grains__.get('roles', []) -%}
{%- set config_dirs = ['', env ~ '/'] -%}
{%- if event_name -%}
  {%- do config_dirs.extend([event_name ~ '/', event_name ~ '_' ~ env ~ '/']) -%}
  {%- if event_year -%}
    {%- do config_dirs.extend([event_name ~ '_' ~ event_year ~ '/', event_name ~ '_' ~ event_year ~ '_' ~ env ~ '/']) -%}
  {%- endif -%}
{%- endif -%}

{%- for config_dir in config_dirs|reverse %}
{{ config_dir }}init.yaml
{%- for role in roles %}
{{ config_dir }}{{ role }}.yaml
{%- endfor %}
{%- endfor -%}

{%- endif -%}
